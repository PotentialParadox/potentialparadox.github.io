<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-01-23 Sat 07:34 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Paper 2</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Dustin Tracy" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Paper 2</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org9fcea52">Introduction</a></li>
<li><a href="#org7324289">Theoretical Methodology </a></li>
<li><a href="#org0e58915">Computational Design </a></li>
<li><a href="#org2c3f0ca">Simulation Methods </a></li>
<li><a href="#org508dfe7">Simulation Results </a>
<ul>
<li><a href="#org5cebcbf">State Populations</a>
<ul>
<li><a href="#org0b551c0">Explanation of the population figure</a></li>
</ul>
</li>
<li><a href="#org0040036">Potential Energies </a></li>
<li><a href="#orgfeb8d1d">Bond Length Adjustment</a></li>
<li><a href="#orgc1e075f">Dihedral Angles</a></li>
<li><a href="#org8423ec6">Wiberg Bond Analysis</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-org9fcea52" class="outline-2">
<h2 id="org9fcea52">Introduction</h2>
<div class="outline-text-2" id="text-org9fcea52">
<p>
During ultra-fast photovolatic processes, the Born-Openheimer
appoximation breaks, and accounting for non-adiabatic behavior become
necessary.  These situations occur frequently within processes of
interest to photochemistry and photophysics.  For example, the
excitation to a non-equlibrium state followed by a relaxation through
internal conversion is a process common to processes such as
photosynthesis, solar-cell photo-absoprtion, optical detectors, and
the excitation of the visual nerve.  Multiple methods to have been
proposed and used to simulate these non-adiabatic processes.  These
methods include treating the nuclear coordinates quantum mechanically
or simiclassically, or by using a hybrid quantum mechanical, classical
treatment to account for the non-adiabaticity.  One of the more
popular version of the latter, and the one which we use in this work,
is Molecular Dynamics with Quantum Transitions (MDQT), were the system
propogates classically along adiabatic potential energy surfaces, but
a quantum evalutation is made at each time step to determine whether
to transition to another state.<br />
</p>
<p>
For many areas in which nonadiabatic dynamics simulations would be of
interest, solvents play a crucial role.  In situations where ultrafast
electronic relaxations occur, the electronic decay is often faster
than the time for the solvent to equilibrate.  As such, Implicit
solvents, which adjusts instantaneously to any changes, become
imprecise approximation However performing non-adiabatic dynamics on
such large systems is far too computationally expensive.  To ease the
computational cost we can employ QM/MM methodologies to perform the
non-adiabatic calculation only on the areas of interest.  Similar
methods have been employed in the study of retinal photochemistry and
organic semiconductors.  In this work we implement a new method of
performing non-adiabatic QM/MM using the SANDER package AMBERTOOLS
combined with the high performance Non-Adiabatic simulator NEXMD.  We
further analyze the effects of including near solvent molecules within
the QM region.<br />
</p>
<p>
NEXMD, currently being developed by the Tretiak lab in los Alamos, has
a proven track record of performance on the stimulation of ultra-fast
non-adiabatic behaviors.  It’s ability to solve state coupling
equations on-the-fly has found great utility for systems with hundreds
of atoms.  Numerous studies have implemented the method for research
into topics including the study of chlorophyll organic conjugated
molecules, and pi conjugated macrocycles.  Such studies with NEXMD
have been limited to implicit solvents.  No method to provide NEXMD
with QM/MM capabilities have yet to be implemented.<br />
</p>
<p>
Amber is primarily known as a classical force-field molecular dynamics
package.  It’s a massive project maintained by people across the globe
that's been designed to work with very large systems ranging in the
tens of thousands of atoms.  Amber is capable of a huge range of
simulations from replica exchange to QM/MM umbrella sampling using
nudge elastic bands.  Most importantly for this research, it has a
proven track record of doing QM/MM solvent-solute simulations using
periodic boundary conditions.<br />
</p>
<p>
This work is split in the four main sections.  In section 1 we discuss
the theoretical methodology behind the computational implementation.
Next , in secton 2, we discuss how we interface NEXMD with AMBER
covering what data was shared, and which package performed which
calculation.  In section 3 we introduce our test system and the
simulation protocol used, from which we analyze the results in
section 4.  Our analysis looks into the effects of using QM/MM on
state population decay, potential energy decay, bond length
adjustements, dihedral angles, and Widberg Bond orders.<br />
</p>
</div>
</div>

<div id="outline-container-org7324289" class="outline-2">
<h2 id="org7324289">Theoretical Methodology </h2>
<div class="outline-text-2" id="text-org7324289">
<p>
Adiatic motion is managed by SANDER using the NEXMD software package to calculate the semiemprical QM energies and forces.
NEXMD uses a modified version of the  SQM package from AMBERTOOlS  for these calcuations which SANDER links to by default.
As such, the ground state energies and forces from SANDER paired with NEXMD vs SANDER in its default configuration are identical. 
This modified version howerver also provides the excited state energies and forces. Previous work have shown methods for linking
these two packages to provide excited state adiabatic QM/MM simulations . <b>Personal Citation.</b> 
</p>

<p>
To find the excited state energies during dynamics, NEXMD employs the collective electronic oscillator (CEO) method developed by Mec&#x2026; etc.
This method is similar to the random phase approximation and is compatible with Kohn-Sham DFT or Hartee-Fock.
</p>

<p>
A quick overview of this methodology is as follows. We start with the Liouville eigenvalue equation.
</p>

\begin{align*}
  \hat{\mathbf{\mathcal{L}}}\mathbf{\rho}_{0\alpha} = \Omega\mathbf{\rho}_{0\alpha}
\end{align*}


<p>
with \(\mathbf{\mathcal{L}}\) being the two-particle Louiville operator and
\(\Omega\) the energy difference between the \(\alpha\) state and the ground
state. \(\rho_{0\alpha}\) is the single- electron density matrix
</p>

\begin{align*}
  (\mathbf{\rho}_{0\alpha})_{nm} =  \left< \psi_{\alpha} \right| c_m^\dagger c_n \left| \psi_0 \right>.
\end{align*}
<p>
where \(\psi_{g}\) and \(\psi_{\alpha}\) are the single-electron wavefunctions for the groundstate and singly excited state \(\alpha\), and
\(c_m^\dagger\) and \(c_n\) are the creation and annihilation operator respectively. The coefficients for the atomic orbital basit sets are derived prior using the QM/MM methodology from the SQM package.\cite{walker2008implementation} The Liouville operator can be found analytically using 
</p>

\begin{align*}
  \hat{\mathbf{\mathcal{L}}}\mathbf{\rho}_{0\alpha} = \left[ \mathbf{F}^{\vec{R}}(\mathbf{\rho}_{00}), \mathbf{\rho}_{0\alpha} \right]
  + \left[ \mathbf{V}^{\vec{R}}(\mathbf{\rho}_{0\alpha}), \mathbf{\rho}_{00} \right]
\end{align*}

<p>
where \(\textbf{F}^{\vec{R}}\) is the Fock operator and \(\textbf{V}^{\vec{R}}\) is the column interchange operator.
</p>

<p>
The forces are also calculated analytically using the gradient of the ground state
energy and the excited state energy.
</p>

\begin{align*}
  \vec{\nabla} E_{\alpha} = \vec{\nabla} E_0 + \vec{\nabla} \Omega_{\alpha}
\end{align*}

<p>
With the gradient of the ground state being calculated by
</p>

\begin{align*}
  \vec{\nabla} E_0 = \frac{1}{2}\mathbf{Tr} \left[ \left( \mathbf{t}^{\vec{R}} + \mathbf{F}^{\vec{R}} \right) \mathbf{\rho}_{00} \right]
\end{align*}
<p>
where \(\textbf{t}\) is the single-electron kinetic operator.
</p>

<p>
The gradient of the excited state can derived using
</p>

\begin{align*}
  \vec{\nabla}\Omega_{\alpha} = \mathbf{Tr} \left[ \mathbf{F}^{\vec{R}} (\mathbf{\rho}_{\alpha\alpha} - \mathbf{\rho}_{00})\right]
  + \mathbf{Tr} \left[\mathbf{V}^{\vec{R}}\mathbf{\rho}_{0\alpha}^\dagger \mathbf{\rho}_{0\alpha} \right]
\end{align*}

<p>
where \(\mathbf{\rho}_{ij}\) represents the density or transition density matrix for states i and
j, \( \mathbf{F} \) is the Fock matrix and \( \mathbf{V} \) is the column interchange operator.
</p>
<p>
The MDQT approach utilized in this work as a modified version of the
Tully Surface Hopping method.  Here the quantum wave function is
approximated using a swarm of independent trajectories.  During time
steps, these trajectories propagate along adiabatic surfaces; However,
between time steps, these trajectories are allowed to transition from
one state to another in a Monte Carlo like fashion.  That number of
trajectories in any given state corresponds to that state's quantum
probability.
</p>
<p>
We define the Hamiltonian
</p>

<p>
where \(\mathbf{T}(\mathbf{R}) \) is the nuclear kinetic energy operator and \(\textbf{H}_{el}\) is the electronic Hamiltonian.
</p>

<p>
We expand the the total wavefunction, \(\Psi\) into the adiabatic state wavefunctions \(\phi\)
</p>
<p>
where \(\textbf{r}\) and \(\textbf{R}\) are the electronic and nuclear coordinates respectively.
</p>


<p>
The matrix elements of the electron Hamiltonian become
</p>

<p>
and the time-dependent Shrodinger equation can then be written as
</p>
<p>
The term \(\left< \phi_j | \dot{\phi}_k \right>\) represents the coupling between the jth and kth state and is most commonly referred to as the nonadiabatic coupling term.
</p>
<p>
At each step we perform a montecarlo like decision
</p>

\begin{equation} \label{eq:tullyjump2} 
\sum_{j=1}^{k-1}g_{ij} < \zeta  \le \sum_{j=1}^{k}g_{ij}
\end{equation}
<p>
hopping from state i to k when
</p>
\begin{equation} \label{eq:tullyjump1} 
  \zeta < g_{ik}
\end{equation}
<p>
where &zeta; is a uniformly distributed random number from 0 to 1, and
</p>

\begin{equation}
g_{ik} = \frac{b_{ki}(t=0)\Delta t}{a_{ii}(t=0)}
\end{equation}

<p>
with
</p>

\begin{equation} \label{eq:tullyb2a} 
b_{kj} =
        \frac{2}{\hbar}\Im\left(a_{kj}^*V_{kj}\right) - 2\Re\left(a_{kj}^*
         \dot{\mathbf{R}} \cdot \mathbf{d}_{kj}\right).
\end{equation}
<p>
\(a_{kj}\) are the off diagonals of the density matrix \(a_{kj} = c_k^* c_j\) and
\(\mathbf{d}_{kj}\) is the non-adiabatic coupling vector
</p>
\begin{equation} \label{eq:tullynacoupling} 
\mathbf{d}_{kj}\mathbf(R) =
  \left<\phi_{k}(\mathbf{r};\mathbf{R})\right|\mathbf{\nabla}_{\mathbf{R}}\left.\phi_j(\mathbf{r};\mathbf{R})\right>.
\end{equation}
<p>
We use the Collect Oscillator Approach to calculate the non-adiabatic coupling
terms \(\mathbf{R} \cdot \mathbf{d}_{kj}\) ``on the
fly''. <a class='org-ref-reference' href="#tommasini2001electronic">tommasini2001electronic</a>,<a class='org-ref-reference' href="#tretiak1996collective">tretiak1996collective</a>,<a class='org-ref-reference' href="#tretiak2009representation">tretiak2009representation</a>,<a class='org-ref-reference' href="#chernyak2000density">chernyak2000density</a>
</p>
<p>
Inconsistencies arise from solely using the Tully surface hopping approach.
Trajectories transfer between  the various adiabatic potential energy surfaces instantaneously based off the QM state coefficients.
These coefficients are determined using the integral of the TDSE on multiple trajectories.
Each trajectory if unmodified will keep in phase even after spatial separation.
Furthermore, if dealing with a system with a dense electronic state structure, its likely that the ordering of these states will switch during general dynamics.
We apply a dechohence correction as well as a trivial crossing accounting system as performed in previous research.
</p>
</div>
</div>
<div id="outline-container-org0e58915" class="outline-2">
<h2 id="org0e58915">Computational Design </h2>
<div class="outline-text-2" id="text-org0e58915">

<div id="org502fc07" class="figure">
<p><img src="./scripted_diagrams/nasqm_overview.png" alt="nasqm_overview.png" /> 
</p>
<p><span class="figure-number">Figure 1: </span>Swim-lane diagram describing the common timestep of the SANDER-NEXMD interface. <div id="scheme:nasqm"></div></p>
</div>
<p>
The swim-lane chart in figure <a href="#scheme:nasqm">scheme:nasqm</a> describes a common time-step that
occurs within the SANDER-NEXMD interface. First users initiate the program
through SANDER, a program found in AMBERTOOLS. SANDER uses NEXMD to calculate
the energies and forces of the QM atoms, check for trivial crossings, and
propagate the quantum coefficients. With these results, SANDER performs the
QM/MM procedures to derive the accelerations and velocities for the classical
time step. NEXMD then decides whether to perform a state transitions, adjusting
the velocities as needed. Finally SANDER propagates the nuclear coordinates and
the cycle continues for the rest of the dynamics.
</p>

<p>
When users initiate SANDER, they're provide the usual SANDER inputs of a
coordinate, parameter, and sander control files. In addition they will include a file specific to
NEXMD which describes the QM and Non-adiabatic behavior.
</p>

<p>
This interface, incorporates SANDER's implementation of QM/MM as described in
previous literature to generate a solvent inclusive ground state density matrix utilized by NEXMD's excited
state calculations.
</p>

<p>
Sander controls the interactions between the QM and MM regions.
</p>


<p>
SANDER calls NEXMD providing the function calls with the QM coordinates, MM
charges, and Langevin thermostat parameters. NEXMD calculates the energies of
the QM atoms with electrostatic interactions from the MM point charges using
CIS, TDHF, or TDDFT. A variety of Hamiltonians are available; however, AM1 has
been shown to provide very reasonable computational cost to accuracy for our
systems of interest.<a class='org-ref-reference' href="#silva2010benchmark">silva2010benchmark</a>. An analysis of parameter choices
can be found in previous literature.<a class='org-ref-reference' href="#nelson2012nonadiabatic">nelson2012nonadiabatic</a>
</p>

<p>
After calculating energies, NEXMD performs a check for non-avoided trivial
crossings. Computational feasibility of this step requires the calculations of
the non-adiabatic coupling.<a class='org-ref-reference' href="#nelson2020non">nelson2020non</a> We use an analytical form of the
non-adiabatic coupling derived using the Hellman-Feynman theorem.
<a class='org-ref-reference' href="#tommasini2001electronic">tommasini2001electronic</a>,<a class='org-ref-reference' href="#chernyak2000density">chernyak2000density</a>
</p>

<p>
\[
 \mathbf{d}_{ab}(\mathbf{R})
= \frac{ \left< \Psi_a (\mathbf{r}, \mathbf{R}) \right| \nabla_\mathbf{R}
\hat{H}_{el} (\mathbf{r}, \mathbf{r}) \left| \Psi_b (\mathbf{r}, \mathbf{R})
\right> } { E_b(\mathbf{R}) - E_a(\mathbf{R}) } 
\] 
</p>

<p>
NEXMD then compares the overlap of the density functions of the current step to
those in the previous state. If a non-avoided trivial crossings is suspected,
addition energy calculations are performed along the interpolation of the
classical step, and overlap matrices are compared. Trivial crossing will result
in a change in state number but will continue to propagate along the most recent
potential energy surface.
</p>

<p>
NEXMD then propagates the quantum coefficients.
Generally, this propagation requires a smaller time-step than whats needed for nuclear coordinate propagation, as such, three or four quantum steps are performed for every classical step. 
These intermediary quantum calculations are performed using nuclear coordinates determined through an interpolation of the classical time step.
Inclusion of the thermostat parameters allow for fined tuned precision in these interpolations.
</p>

<p>
Forces are then determined using the analytical solution to the gradient of the energies.
For the ground state,
</p>
\begin{align*}
  \vec{\nabla} E_0 = \frac{1}{2}\mathbf{Tr} \left[ \left( \mathbf{t}^{\vec{R}} + \mathbf{F}^{\vec{R}} \right) \mathbf{\rho}_{00} \right]
\end{align*},
and for the excitation energy
\begin{align*}
  \vec{\nabla}\Omega = \mathbf{Tr} \left[ \mathbf{F}^{\vec{R}} (\mathbf{\rho}_{\alpha\alpha} - \mathbf{\rho}_{00})\right]
  + \mathbf{Tr} \left[\mathbf{V}^{\vec{R}}\mathbf{\rho}_{0\alpha}^\dagger \mathbf{\rho}_{0\alpha} \right]
\end{align*}
<p>
where \(\mathbf{\rho}_{ij}\) represents the density or transition density matrix for states i and
j, \( \mathbf{F} \) is the Fock matrix,  \( \mathbf{t} \) is the kinetic operator acting on
one-electron and \( \mathbf{V} \) is the column interchange operator.
</p>

<p>
The energies, forces, and electron densities are returned to SANDER where SANDER's built in QM/MM routines performs the QM/MM calculations using the excited state electron density. 
The resulting total forces are then used to update the velocities for both MM and QM atoms for a single timestep and are passed back into NEXMD. 
</p>

<p>
The aformentioned probability of hopping mentioned in theoretical methods can be expanded to 
\[ 
g_{\alpha \rightarrow \beta} = 
-\frac{\Delta t}{\hbar}
\frac{2\Re\left( c_\alpha(t)c_\beta^*(t) \dot{\vec{R}} \cdot \vec{d}_{\alpha\beta} \right)}
{| c_\alpha(t) |^2} 
\] 
which NEXMD now uses to determine whether a hop between the adiabatic states should occur.
If a hop occurs, the nuclear velocities are adjusted along the non-adiabatic coupling vector to conserve energy. 
If a state transition occurs, the velocities of the nuclear atoms are adjusted along the non-adiabatic coupling vectors to conserve energy.
With the new state chosen, AMBER now uses the average velocities to propagate the nuclear coordinates.
New random numbers are generated for the thermostats when appropriate.
</p>
</div>
</div>

<div id="outline-container-org2c3f0ca" class="outline-2">
<h2 id="org2c3f0ca">Simulation Methods </h2>
<div class="outline-text-2" id="text-org2c3f0ca">

<div id="orgfbdea2b" class="figure">
<p><img src="./scripted_diagrams/simulations-1.png" alt="simulations-1.png" />
</p>
</div>
<p>
We equilibrated the system to a temperature set to 300K. To collect a broad
enough sampling, we sampled from a 1024 ps, with a 0.5 fs timestep fully
classical trajectories using the AMBER force field. We performed a separate
trajectory for each situation combination of solute / with solvent including
whether the solvent was included in the QM calculations. We had a total of 6
separate 1024 ps classical trajectories, PPV3 in Vacuum, CH<sub>3OH</sub>, and 5QM CH<sub>3OH</sub>
and PPV<sub>3</sub>-NO<sub>2</sub> in Vacuum, CH<sub>3OH</sub>, and 5QM CH<sub>3OH</sub>. 1024 snapshots where taken at
1ps, 2ps .. 1024ps. We used the final frame of those tranjectories as the
initial conditions for an additional 4ps using the AM1 semiempical Hamiltonian
Born-Oppenheimer on the molecules to be included in future QM calculations to
allow the system to relax. The 4 ps timescale was determined using the
information form the previous paper. The simulations were described the Langevin
equations at a temperature set to 300 K with the Langevin friction parameter set
to 2 ps<sup>-1</sup>. The final frames of these QM trajectories were then used as the
initial conditions for the following pulse pump calculations.
</p>
<p>
Pump-Probe Spectroscopy is an experimental technique commonly performed in the
study of ultrafast electonic statte dynamics. In the case of conjugated polymers
in can be used to study the localized excictronic transitions that are
accessible through an excitation from the S1 state but not the ground state S0.
To simulate this behavior, we take the final snapshot of the QM ground state
calculations and perform a single point calculation at the S1 state to find the
next state with the highest oscillator strength.
</p>
</div>
</div>
<div id="outline-container-org508dfe7" class="outline-2">
<h2 id="org508dfe7">Simulation Results </h2>
<div class="outline-text-2" id="text-org508dfe7">
</div>
<div id="outline-container-org5cebcbf" class="outline-3">
<h3 id="org5cebcbf">State Populations</h3>
<div class="outline-text-3" id="text-org5cebcbf">

<div id="orge6e104a" class="figure">
<p><img src="file:///home/dustin/potentialparadox.github.io/Paper2/Images/populations/solvent_comparison.png" alt="solvent_comparison.png" />
</p>
<p><span class="figure-number">Figure 3: </span>Comparison of the population decays or rises of states S<sub>1</sub>, S<sub>2</sub>, and the initial state S<sub>m</sub> between simulations with varying number of solvents included in the QM region.</p>
</div>
</div>
<div id="outline-container-org0b551c0" class="outline-4">
<h4 id="org0b551c0">Explanation of the population figure</h4>
<div class="outline-text-4" id="text-org0b551c0">
</div>
</div>

<div class="outline-text-3" id="text-org5cebcbf">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> Fitting Parameters for the model of the rise of the S<sub>1</sub> population. <div id="table:s1"></div></caption>

<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Solvent</td>
<td class="org-right">\(\tau\) (fs)</td>
<td class="org-right">A</td>
</tr>

<tr>
<td class="org-left">Vacuum</td>
<td class="org-right">671</td>
<td class="org-right">1.16</td>
</tr>

<tr>
<td class="org-left">CH<sub>3</sub>OH</td>
<td class="org-right">693</td>
<td class="org-right">1.06</td>
</tr>

<tr>
<td class="org-left">CH<sub>3</sub>OH with 5QM</td>
<td class="org-right">550</td>
<td class="org-right">1.10</td>
</tr>

<tr>
<td class="org-left">CH<sub>3</sub>OH with 10QM</td>
<td class="org-right">93.8</td>
<td class="org-right">1.61</td>
</tr>
</tbody>
</table>
</div>

<div class="outline-text-3" id="text-org5cebcbf">
<p>
Figure <a href="#fig:all-populations">fig:all-populations</a> shows the population of each state calculated as
the number of trajectories at the state's potential energy surface over the
total number of trajectories. S<sub>m</sub> represents the initial state calculated using
the pulse pump calculations previously done. States S<sub>7</sub> and S<sub>9</sub> are included as
the only other "slow" states, or states that reached a population of more than
0.05. The other states were excluded from the graph. These charts show that the
addition of the NO<sub>2</sub> oligimors dramatically speed up the state relaxation. S<sub>m</sub>
ranged from S<sub>9</sub> to S<sub>15</sub> for PPV<sub>3</sub> and S<sub>11</sub> to S<sub>21</sub> for PPV<sub>3</sub>-NO<sub>2</sub>. Figure
<a href="#fig:s1-populations">fig:s1-populations</a>, shows the rise of the S<sub>1</sub> populations over the first
500 fs after excitation. We model these rises by fitting the curves to the
function
</p>
\begin{equation}
f(t) = \frac{Ae^{t/\tau}}{A+e^{t/\tau}} - \frac{A}{1+A}
\end{equation}
<p>
where \(t\) is time, \(\tau\) is the relaxation, and \(A\) is a constant that
normalizes such that the populations remain between 0 and 1. The results are displayed in <a href="#table:s1">table:s1</a>. 
We clearly see that adding a test for trivial-nonavoided crossing slows the rate
of relaxation from a time constant of 258~fs. This is to be expected since we
are now preventing transitions (mostly downward) that should not occur. The
methanol have mixed results with regards to PPV3 and seem to slightly slow the
relaxation of PPV3-NO<sub>2</sub>. Experiments using ultrafast spectroscopy have shown that
for PPV thin films the time constant for relaxations should be around 200 fs.
However, that was on thin films and for PPV<sub>3</sub>, the energy gap !! Average S<sub>1</sub> -&gt;
S<sub>m</sub> energy gap) than in the thin film (0.8eV). Previous research using the
NAESMD framework have shown a time constant of 394 fs, but this was without the
test for trivial non-avoided crossings.
</p>



<div id="orgc0247f0" class="figure">
<p><img src="./Images/population_fit_tabulation/s1.png" alt="s1.png" />
</p>
<p><span class="figure-number">Figure 4: </span>Population of the first excited state (S<sub>1</sub>) of PPV<sub>3</sub> and PPV<sub>3</sub>-NO<sub>2</sub> in various solvents obtained from the fraction of trajectories in each state. <div id="fig:s1-populations"></div></p>
</div>
</div>
</div>

<div id="outline-container-org0040036" class="outline-3">
<h3 id="org0040036">Potential Energies </h3>
<div class="outline-text-3" id="text-org0040036">

<div id="orge5ef115" class="figure">
<p><img src="./Images/potential_energies/solvent_comparison.png" alt="solvent_comparison.png" />
</p>
<p><span class="figure-number">Figure 5: </span>Potential energy during dynamics averaged over trajectories.</p>
</div>
</div>
</div>

<div id="outline-container-orgfeb8d1d" class="outline-3">
<h3 id="orgfeb8d1d">Bond Length Adjustment</h3>
<div class="outline-text-3" id="text-orgfeb8d1d">

<div id="org380b4b4" class="figure">
<p><img src="./Images/bla/vacuum.png" alt="vacuum.png" />
</p>
<p><span class="figure-number">Figure 6: </span>Bond Length Adjustments for various states for PPV<sub>3</sub> and PPV<sub>3</sub>-NO<sub>2</sub> in vacuum. <div id="fig:bla-vacuum"></div></p>
</div>
<p>
The BLA for both PPV<sub>3</sub> and PPV<sub>3</sub>-NO<sub>2</sub> in
vacuum the ground state varies very little the two. We use shades of red the
display the ground-state and shades of green to represent states that start in
S<sub>m</sub> and shades of blue the describe a first excited state trajectores. The
ground state has very little variation. The first excited state splits in PPV<sub>3</sub>-NO<sub>2</sub>,
with the Far Side being described as being the furthest from the Nitro goup.  
States SM and state S1 the atom group further from the Nitro group had a more
distinct variation than the bla with the groups nearest the Nitro group The
variation is most distinct and the first excited States the difference between
the them on the S<sub>m</sub> closed group is very much smaller and similar to what we found in
the The potential Energies The Barley the Judgment relaxation, and ppb 3 ml to
is significantly faster than that time of PPP. The ground-state energy that we
found matches values performed from the previous research by Tammie as does the
S5 started to take pla Big billy for the states for the trajectories that
started in the initial M States showed a slider longer time for relaxation than
that found and Tammy's research. FIXME I need to add Tammy's ballet data to the
Bone length adjustment. The very quick relaxation of the bla in the states
suggest that very quickly after the initial excitation, PPV<sub>3</sub>-NO<sub>2</sub> quickly
stabilizes and flattens within first 500 fs. Later we will compare this
to the dihedral angle to see if this matches our expectations. Previous research
has shown that after this acceptation an actual Bond indices at the Scribe by
the Wydber index shrinks well showing that the single bonds gain a significant
amount double bond characteristics causing the molecule to Stiffen.
</p>
</div>
</div>

<div id="outline-container-orgc1e075f" class="outline-3">
<h3 id="orgc1e075f">Dihedral Angles</h3>
<div class="outline-text-3" id="text-orgc1e075f">
<p>
The torsion angle around the vinylene segments have been shown to be highly coupled to the excited state. <a class='org-ref-reference' href="#nelson2011nonadiabatic">nelson2011nonadiabatic</a>,<a class='org-ref-reference' href="#panda2013electronically">panda2013electronically</a>  
</p>

<div id="org85916d0" class="figure">
<p><img src="./Images/dihedral/vacuum.png" alt="vacuum.png" />
</p>
<p><span class="figure-number">Figure 7: </span>Dihedral angles for various states for PPV<sub>3</sub> and PPV<sub>3</sub>-NO<sub>2</sub> in vacuum. <div id="fig:dihedral-vacuum"></div></p>
</div>
</div>
</div>
<div id="outline-container-org8423ec6" class="outline-3">
<h3 id="org8423ec6">Wiberg Bond Analysis</h3>
<div class="outline-text-3" id="text-org8423ec6">
</div>
</div>

<div class="outline-text-2" id="text-org508dfe7">
<p>

<h1 class='org-ref-bib-h1'>Bibliography</h1>
<ul class='org-ref-bib'><li><a id="demoulin2017fine">[demoulin2017fine]</a> <a name="demoulin2017fine"></a>Demoulin, Altavilla, Rivalta & Garavelli, Fine tuning of retinal photoinduced decay in solution, <i>The journal of physical chemistry letters</i>, <b>8(18)</b>, 4407-4412 (2017).</li>
<li><a id="weingart2012modelling">[weingart2012modelling]</a> <a name="weingart2012modelling"></a>Weingart & Garavelli, Modelling vibrational coherence in the primary rhodopsin photoproduct, <i>The Journal of chemical physics</i>, <b>137(22)</b>, 22A523 (2012).</li>
<li><a id="heck2015multi">[heck2015multi]</a> <a name="heck2015multi"></a>Heck, Kranz, Kubař & Elstner, Multi-scale approach to non-adiabatic charge transport in high-mobility organic semiconductors, <i>Journal of chemical theory and computation</i>, <b>11(11)</b>, 5068-5082 (2015).</li>
<li><a id="zheng2017photoinduced">[zheng2017photoinduced]</a> <a name="zheng2017photoinduced"></a>Zheng, Fernandez-Alberti, Tretiak & Zhao, Photoinduced intra-and intermolecular energy transfer in chlorophyll a dimer, <i>The Journal of Physical Chemistry B</i>, <b>121(21)</b>, 5331-5339 (2017).</li>
<li><a id="nelson2014nonadiabatic">[nelson2014nonadiabatic]</a> <a name="nelson2014nonadiabatic"></a>Nelson, Fernandez-Alberti, Roitberg & Tretiak, Nonadiabatic excited-state molecular dynamics: Modeling photophysics in organic conjugated materials, <i>Accounts of chemical research</i>, <b>47(4)</b>, 1155-1164 (2014).</li>
<li><a id="alfonso2016interference">[alfonso2016interference]</a> <a name="alfonso2016interference"></a>Alfonso Hernandez, Nelson, Gelin, Lupton, Tretiak & Fernandez-Alberti, Interference of interchromophoric energy-transfer pathways in $\pi$-conjugated macrocycles, <i>The journal of physical chemistry letters</i>, <b>7(23)</b>, 4936-4944 (2016).</li>
<li><a id="cruzeiro2020exploring">[cruzeiro2020exploring]</a> <a name="cruzeiro2020exploring"></a>Cruzeiro, Feliciano & Roitberg, Exploring Coupled Redox and pH Processes with a Force-Field-Based Approach: Applications to Five Different Systems, <i>Journal of the American Chemical Society</i>, <b>142(8)</b>, 3823-3835 (2020).</li>
<li><a id="ghoreishi2019fast">[ghoreishi2019fast]</a> <a name="ghoreishi2019fast"></a>Ghoreishi, Cerutti, Fallon, Simmerling & Roitberg, Fast Implementation of the Nudged Elastic Band Method in AMBER, <i>Journal of chemical theory and computation</i>, <b>15(8)</b>, 4699-4707 (2019).</li>
<li><a id="sarkar2019ph">[sarkar2019ph]</a> <a name="sarkar2019ph"></a>Sarkar, Gupta & Roitberg, pH-Dependent Conformational Changes Due to Ionizable Residues in a Hydrophobic Protein Interior: The Study of L25K and L125K Variants of SNase, <i>The Journal of Physical Chemistry B</i>, <b>123(27)</b>, 5742-5754 (2019).</li>
<li><a id="case2020a">[case2020a]</a> <a name="case2020a"></a>@misccase2020a,
  author = Case, D.A. and Belfon, K. and Ben-Shalom, I.Y. and Brozell, S.R. and Cerutti, D.S. and T.E. Cheatham, III, V.W.D.Cruzeiro and Darden, T.A. and Duke, R.E. and Giambasu, G. and Gilson, M.K. and Gohlke, H. and Goetz, A.W. and Harris, R. and Izadi, S. and Izmailov, S.A. and Kasavajhala, K. and Kovalenko, A. and Krasny, R. and Kurtzman, T. and Lee, T.S. and LeGrand, S. and Li, P. and Lin, C. and Liu, J. and Luchko, T. and Luo, R. and Man, V. and Merz, K.M. and Miao, Y. and Mikhailovskii, O. and Monard, G. and Nguyen, H. and Onufriev, A. and F.Pan, S.Pantano and Qi, R. and Roe, D.R. and Roitberg, A. and Sagui, C. and Schott-Verdugo, S. and Shen, J. and Simmerling, C. and N.R.Skrynnikov, J.Smith and Swails, J. and Walker, R.C. and Wang, J. and Wilson, L. and Wolf, R.M. and Wu, X. and Xiong, Y. and Xue, Y. and York, D.M. and Kollman, P.A.,
  date = 2020,
  publisher = University of California,
  language = it,
  type = AMBER 2020,,
  address = San Francisco
</li>
<li><a id="tully2012perspective">[tully2012perspective]</a> <a name="tully2012perspective"></a>Tully, Perspective: Nonadiabatic dynamics theory, <i>The Journal of chemical physics</i>, <b>137(22)</b>, 22A301 (2012).</li>
<li><a id="tully1990molecular">[tully1990molecular]</a> <a name="tully1990molecular"></a>Tully, Molecular dynamics with electronic transitions, <i>The Journal of Chemical Physics</i>, <b>93(2)</b>, 1061-1071 (1990).</li>
<li><a id="tommasini2001electronic">[tommasini2001electronic]</a> <a name="tommasini2001electronic"></a>Tommasini, Chernyak & Mukamel, Electronic density-matrix algorithm for nonadiabatic couplings in molecular dynamics simulations, <i>International Journal of Quantum Chemistry</i>, <b>85(4-5)</b>, 225-238 (2001).</li>
<li><a id="tretiak1996collective">[tretiak1996collective]</a> <a name="tretiak1996collective"></a>Tretiak, Chernyak & Mukamel, Collective electronic oscillators for nonlinear optical response of conjugated molecules, <i>Chemical physics letters</i>, <b>259(1-2)</b>, 55-61 (1996).</li>
<li><a id="tretiak2009representation">[tretiak2009representation]</a> <a name="tretiak2009representation"></a>Tretiak, Isborn, Niklasson & Challacombe, Representation independent algorithms for molecular response calculations in time-dependent self-consistent field theories, <i>The Journal of chemical physics</i>, <b>130(5)</b>, 054111 (2009).</li>
<li><a id="chernyak2000density">[chernyak2000density]</a> <a name="chernyak2000density"></a>Chernyak & Mukamel, Density-matrix representation of nonadiabatic couplings in time-dependent density functional (TDDFT) theories, <i>The Journal of Chemical Physics</i>, <b>112(8)</b>, 3572-3579 (2000).</li>
<li><a id="silva2010benchmark">[silva2010benchmark]</a> <a name="silva2010benchmark"></a>Silva-Junior & Thiel, Benchmark of electronically excited states for semiempirical methods: Mndo, AM1, PM3, OM1, OM2, OM3, INDO/S, and INDO/S2, <i>Journal of chemical theory and computation</i>, <b>6(5)</b>, 1546-1564 (2010).</li>
<li><a id="nelson2012nonadiabatic">[nelson2012nonadiabatic]</a> <a name="nelson2012nonadiabatic"></a>Nelson, Fernandez-Alberti, Chernyak, Roitberg & Tretiak, Nonadiabatic excited-state molecular dynamics: Numerical tests of convergence and parameters, <i>The Journal of chemical physics</i>, <b>136(5)</b>, 054108 (2012).</li>
<li><a id="nelson2020non">[nelson2020non]</a> <a name="nelson2020non"></a>Nelson, White, Bjorgaard, Sifain, Zhang, Nebgen, Fernandez-Alberti, Mozyrsky, Roitberg & Tretiak, Non-adiabatic Excited-State Molecular Dynamics: Theory and Applications for Modeling Photophysics in Extended Molecular Materials, <i>Chemical Reviews</i>, <b>120(4)</b>, 2215-2287 (2020).</li>
<li><a id="nelson2011nonadiabatic">[nelson2011nonadiabatic]</a> <a name="nelson2011nonadiabatic"></a>Nelson, Fernandez-Alberti, Chernyak, Roitberg & Tretiak, Nonadiabatic excited-state molecular dynamics modeling of photoinduced dynamics in conjugated molecules, <i>The Journal of Physical Chemistry B</i>, <b>115(18)</b>, 5402-5414 (2011).</li>
<li><a id="panda2013electronically">[panda2013electronically]</a> <a name="panda2013electronically"></a>Panda, Plasser, Aquino, Burghardt & Lischka, Electronically excited states in poly (p-phenylenevinylene): vertical excitations and torsional potentials from high-level ab initio calculations, <i>The Journal of Physical Chemistry A</i>, <b>117(10)</b>, 2181-2189 (2013).</li>
</ul>
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Dustin Tracy</p>
<p class="date">Created: 2021-01-23 Sat 07:34</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
